(this["webpackJsonpkarteikarten-webapp"]=this["webpackJsonpkarteikarten-webapp"]||[]).push([[0],{42:function(e,t,a){},63:function(e,t,a){e.exports=a(89)},68:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(26),o=a.n(r),l=(a(68),a(49)),s=a(50),i=a(61),u=a(51),m=a(62),d=(a(42),a(12)),p=a(16),b=(a(73),a(19)),f=Object(b.a)(),v=a(21),E=a(60),h=a(11),x=a(7),O={loggedIn:!1},g={newCollection:null,newCard:null,editCollection:null,collections:[]},j={reviewCollection:null,cardIndex:0,scorecards:[]},k={busy:!1,error:null},w=a(29),y={globalContext:{}},C=Object(v.c)({routing:h.routerReducer,network:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;return"pending"===t.status?Object(x.a)({},e,{busy:!0}):"error"===t.status?Object(x.a)({},e,{busy:!1,error:t.error}):"success"===t.status?Object(x.a)({},e,{error:null,busy:!1}):k},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;if("pending"===t.status)return e;switch(t.type){case"login":return"success"===t.status?(localStorage.setItem("access_token",t.accessToken),Object(x.a)({},e,{loggedIn:!0})):(localStorage.removeItem("access_token"),Object(x.a)({},e,{loggedIn:!1}));default:return e}},coreData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;if("pending"===t.status)return e;switch(t.type){case"create-collection":return"success"===t.status?Object(x.a)({},e,{newCollection:Object(x.a)({},t.collection,{items:[]})}):e;case"create-card-in-new-collection":return"success"===t.status&&e.newCollection&&t.collection.id===e.newCollection.id?Object(x.a)({},e,{newCollection:Object(x.a)({},e.newCollection,{item_ids:e.newCollection.item_ids.concat(t.card.id),items:e.newCollection.items.concat(t.card)}),newCard:t.card}):e;case"update-card-in-collection":if("success"===t.status){var a=Object(x.a)({},t.collection,{items:t.collection.items.map((function(e){return e.id===t.card.id?t.card:e}))});return Object(x.a)({},e,{editCollection:a})}return e;case"fetch-collections":case"fetch-recent-collections":return"success"===t.status?Object(x.a)({},e,{collections:t.collections}):e;case"view-collection":return"success"===t.status?Object(x.a)({},e,{editCollection:Object(x.a)({},t.collection)}):e;case"update-collection":return"success"===t.status?Object(x.a)({},e,{editCollection:Object(x.a)({},e.editCollection,{},t.collection)}):e;default:return e}},review:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;if("pending"===t.status)return e;switch(t.type){case"review-collection":return"success"===t.status?Object(x.a)({},e,{scorecards:[],reviewCollection:Object(x.a)({},t.collection),cardIndex:t.cardIndex,complete:!1}):e;case"review-card":return"success"===t.status?Object(x.a)({},e,{cardIndex:t.cardIndex}):e;case"answer-match":return"success"===t.status?Object(x.a)({},e,{scorecards:e.scorecards.concat(t.scorecard)}):e;case"review-result":return"success"===t.status?Object(x.a)({},e,{complete:!0}):e;default:return e}},media:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;if("pending"===t.status)return e;if("success"!==t.status)return e;switch(t.type){case"upload-asset":case"rotate-image-left":case"rotate-image-right":return Object(x.a)({},e,Object(w.a)({},t.mediaContext,t.media))}return e}}),N=a(8),I=a.n(N),_=a(4);function S(e,t){var a,n,c,r,o=arguments;return I.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return a=o.length>2&&void 0!==o[2]?o[2]:null,n=localStorage.getItem("access_token"),c=Object(x.a)({"Content-Type":"application/json"},n?{Authorization:"Bearer ".concat(n)}:{}),a instanceof FormData&&delete c["Content-Type"],l.next=6,I.a.awrap(fetch(e,{method:t,headers:c,body:"application/json"===c["Content-Type"]?a&&JSON.stringify(a):a}));case 6:if(!((r=l.sent).status<500)){l.next=11;break}return l.abrupt("return",r.json());case 11:return l.abrupt("return",r.text());case 12:case"end":return l.stop()}}))}function D(e){return I.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",S(e,"GET"));case 1:case"end":return t.stop()}}))}var P=function(e){return{post:function(t,a){return function(e,t){return I.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",S(e,"POST",t));case 1:case"end":return a.stop()}}))}("".concat(e).concat(t),a)},patch:function(t,a){return function(e,t){return I.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",S(e,"PATCH",t));case 1:case"end":return a.stop()}}))}("".concat(e).concat(t),a)},put:function(t,a){return function(e,t){return I.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",S(e,"PUT",t));case 1:case"end":return a.stop()}}))}("".concat(e).concat(t),a)},get:function(t){return D("".concat(e).concat(t))}}},T=I.a.mark(F),L=I.a.mark(R),M=P("https://karteikarten.herokuapp.com").post;function F(e){var t,a;return I.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.authData,n.next=3,M("/auth/register",{id_token:t.tokenId});case 3:if((a=n.sent).ok){n.next=9;break}return n.next=7,Object(_.b)({type:"login",status:"error",error:a.error});case 7:n.next=13;break;case 9:return n.next=11,Object(_.b)({type:"login",status:"success",accessToken:a.access_token});case 11:return n.next=13,Object(_.b)(Object(h.replace)("/"));case 13:case"end":return n.stop()}}),T)}function R(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)((function(e){var t=e.type,a=e.status;return"login"===t&&"pending"===a}),F);case 2:case"end":return e.stop()}}),L)}var A=a(33),B=I.a.mark(ee),V=I.a.mark(te),z=I.a.mark(ae),W=I.a.mark(ne),Y=I.a.mark(ce),X=I.a.mark(re),J=I.a.mark(oe),K=I.a.mark(le),U=I.a.mark(se),G=I.a.mark(ie),H=I.a.mark(ue),q=P("https://karteikarten.herokuapp.com"),$=q.get,Q=q.patch,Z=q.post;function ee(e){var t,a;return I.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.collection,n.next=3,Z("/collections",t);case 3:if((a=n.sent).ok){n.next=9;break}return n.next=7,Object(_.b)({type:"create-collection",status:"error",error:a.error});case 7:n.next=13;break;case 9:return n.next=11,Object(_.b)({type:"create-collection",status:"success",collection:a.collection});case 11:return n.next=13,Object(_.b)(Object(h.replace)("/create-collection/step-1"));case 13:case"end":return n.stop()}}),B)}function te(e){var t,a,n,c,r;return I.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.type,a=e.collection,n=e.card,o.next=3,Z("/cards",n);case 3:if((c=o.sent).ok){o.next=8;break}return o.next=7,Object(_.b)({type:t,status:"error",error:c.error});case 7:return o.abrupt("return");case 8:return o.next=10,Q("/collections/".concat(a.id),{item_ids:a.item_ids.concat(c.card.id)});case 10:if(r=o.sent,c.ok){o.next=15;break}return o.next=14,Object(_.b)({type:t,status:"error",error:r.error});case 14:return o.abrupt("return");case 15:if("create-card-in-new-collection"!==t){o.next=20;break}return o.next=18,Object(_.b)({type:t,status:"success",collection:r.collection,card:c.card});case 18:o.next=22;break;case 20:return o.next=22,ce({collectionId:r.collection.id});case 22:case"end":return o.stop()}}),V)}function ae(e){var t;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$("/collections?features=stats");case 2:if((t=e.sent).ok){e.next=7;break}return e.next=6,Object(_.b)({type:"fetch-collections",status:"error",error:t.error});case 6:return e.abrupt("return");case 7:return e.next=9,Object(_.b)({type:"fetch-collections",status:"success",collections:t.collections});case 9:case"end":return e.stop()}}),z)}function ne(e){var t,a;return I.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.type,n.next=3,$("/collections/recent?features=stats");case 3:if((a=n.sent).ok){n.next=8;break}return n.next=7,Object(_.b)({type:t,status:"error",error:a.error});case 7:return n.abrupt("return");case 8:return n.next=10,Object(_.b)({type:t,status:"success",collections:a.collections});case 10:case"end":return n.stop()}}),W)}function ce(e){var t,a;return I.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.collectionId,n.next=3,$("/collections/".concat(t));case 3:if((a=n.sent).ok){n.next=8;break}return n.next=7,Object(_.b)({type:"view-collection",status:"error",error:a.error});case 7:return n.abrupt("return");case 8:return n.next=10,Object(_.b)({type:"view-collection",status:"success",collection:a.collection});case 10:case"end":return n.stop()}}),Y)}function re(e){var t,a,n,c;return I.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.collection,a=t.id,n=Object(A.a)(t,["id"]),r.next=3,Q("/collections/".concat(a),n);case 3:if((c=r.sent).ok){r.next=8;break}return r.next=7,Object(_.b)({type:"update-collection",status:"error",error:c.error});case 7:return r.abrupt("return");case 8:return r.next=10,Object(_.b)({type:"update-collection",status:"success",collection:c.collection});case 10:case"end":return r.stop()}}),X)}function oe(e){var t,a,n,c,r,o;return I.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.type,a=e.collection,n=e.card,c=n.id,r=Object(A.a)(n,["id"]),l.next=3,Q("/cards/".concat(c),r);case 3:if((o=l.sent).ok){l.next=8;break}return l.next=7,Object(_.b)({type:t,status:"error",error:o.error});case 7:return l.abrupt("return");case 8:return l.next=10,Object(_.b)({type:t,status:"success",collection:a,card:o.card});case 10:case"end":return l.stop()}}),J)}function le(e){var t,a,n,c,r,o,l;return I.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.type,a=e.cardId,n=e.toCollectionId,s.next=3,Object(_.c)((function(e){return e.coreData.editCollection.id}));case 3:return c=s.sent,s.next=6,$("/collections/".concat(n));case 6:if(r=s.sent,o=r.collection){s.next=12;break}return s.next=11,Object(_.b)({type:"copy-card",status:"error",error:"Collection not found"});case 11:return s.abrupt("return");case 12:return s.next=14,Q("/collections/".concat(n),Object(x.a)({},o,{item_ids:o.item_ids.concat(a)}));case 14:if((l=s.sent).ok){s.next=19;break}return s.next=18,Object(_.b)({type:"copy-card",status:"error",error:l.error});case 18:return s.abrupt("return");case 19:return s.next=21,Object(_.b)({type:t,status:"success",collection:l.collection});case 21:return s.next=23,ce({collectionId:c});case 23:case"end":return s.stop()}}),K)}function se(e){var t,a,n,c,r,o,l,s,i,u,m;return I.a.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return t=e.type,a=e.cardId,n=e.toCollectionId,d.next=3,$("/cards/".concat(a));case 3:if(c=d.sent,r=c.card){d.next=9;break}return d.next=8,Object(_.b)({type:"clone-card",status:"error",error:"Card not found"});case 8:return d.abrupt("return");case 9:return d.next=11,Z("/cards",{front:r.front,back:r.back});case 11:if(o=d.sent,l=o.card,s=(l=void 0===l?{}:l).id){d.next=19;break}return d.next=18,Object(_.b)({type:"clone-card",status:"error",error:"Card not found"});case 18:return d.abrupt("return");case 19:return d.next=21,$("/collections/".concat(n));case 21:if(i=d.sent,u=i.collection){d.next=27;break}return d.next=26,Object(_.b)({type:"clone-card",status:"error",error:"Collection not found"});case 26:return d.abrupt("return");case 27:return d.next=29,Q("/collections/".concat(n),Object(x.a)({},u,{item_ids:u.item_ids.map((function(e){return e===a?s:e}))}));case 29:if((m=d.sent).ok){d.next=34;break}return d.next=33,Object(_.b)({type:"clone-card",status:"error",error:m.error});case 33:return d.abrupt("return");case 34:return d.next=36,Object(_.b)({type:t,status:"success",collection:m.collection});case 36:return d.next=38,ce({collectionId:n});case 38:case"end":return d.stop()}}),U)}function ie(e){var t,a,n,c,r,o,l,s,i,u;return I.a.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return t=e.type,a=e.cardId,n=e.fromCollectionId,c=e.toCollectionId,m.next=3,$("/collections/".concat(n));case 3:if(r=m.sent,o=r.collection){m.next=9;break}return m.next=8,Object(_.b)({type:"move-card",status:"error",error:"Collection not found"});case 8:return m.abrupt("return");case 9:return m.next=11,$("/collections/".concat(c));case 11:if(l=m.sent,s=l.collection){m.next=17;break}return m.next=16,Object(_.b)({type:"move-card",status:"error",error:"Collection not found"});case 16:return m.abrupt("return");case 17:return m.next=19,Q("/collections/".concat(n),Object(x.a)({},o,{item_ids:o.item_ids.filter((function(e){return e!==a}))}));case 19:if((i=m.sent).ok){m.next=24;break}return m.next=23,Object(_.b)({type:"copy-card",status:"error",error:i.error});case 23:return m.abrupt("return");case 24:return m.next=26,Q("/collections/".concat(c),Object(x.a)({},s,{item_ids:s.item_ids.concat(a)}));case 26:if((u=m.sent).ok){m.next=31;break}return m.next=30,Object(_.b)({type:"copy-card",status:"error",error:u.error});case 30:return m.abrupt("return");case 31:return m.next=33,Object(_.b)({type:t,status:"success"});case 33:return m.next=35,ce({collectionId:n});case 35:case"end":return m.stop()}}),G)}function ue(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)((function(e){var t=e.type,a=e.status;return"create-collection"===t&&"pending"===a}),ee);case 2:return e.next=4,Object(_.d)((function(e){var t=e.type,a=e.status;return("create-card-in-new-collection"===t||"create-card-in-collection"===t)&&"pending"===a}),te);case 4:return e.next=6,Object(_.d)((function(e){var t=e.type,a=e.status;return"update-card-in-collection"===t&&"pending"===a}),oe);case 6:return e.next=8,Object(_.d)((function(e){var t=e.type,a=e.status;return"fetch-collections"===t&&"pending"===a}),ae);case 8:return e.next=10,Object(_.d)((function(e){var t=e.type,a=e.status;return"fetch-recent-collections"===t&&"pending"===a}),ne);case 10:return e.next=12,Object(_.d)((function(e){var t=e.type,a=e.status;return"view-collection"===t&&"pending"===a}),ce);case 12:return e.next=14,Object(_.d)((function(e){var t=e.type,a=e.status;return"update-collection"===t&&"pending"===a}),re);case 14:return e.next=16,Object(_.d)((function(e){var t=e.type,a=e.status;return"copy-card"===t&&"pending"===a}),le);case 16:return e.next=18,Object(_.d)((function(e){var t=e.type,a=e.status;return"move-card"===t&&"pending"===a}),ie);case 18:return e.next=20,Object(_.d)((function(e){var t=e.type,a=e.status;return"clone-card"===t&&"pending"===a}),se);case 20:case"end":return e.stop()}}),H)}var me=a(53),de=a.n(me),pe=I.a.mark(xe),be=I.a.mark(Oe),fe=I.a.mark(ge),ve=P("https://karteikarten.herokuapp.com"),Ee=ve.get,he=ve.patch;function xe(e){var t,a,n,c,r;return I.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.collectionId,o.next=3,Ee("/collections/".concat(t));case 3:if((a=o.sent).ok){o.next=8;break}return o.next=7,Object(_.b)({type:"review-collection",status:"error",error:a.error});case 7:return o.abrupt("return");case 8:return o.next=10,he("/me/recent-collections",{collection_id:t});case 10:return(n=a.collection.items).sort((function(){return Math.round(2*Math.random()-1)})),4,c=de()(n,"back"),r=n.map((function(e){var t=new Array(Math.min(c.length-1,4)).fill(0).map((function(){return c[Math.floor(Math.random()*c.length)]})),a=t.findIndex((function(t){return e.back===t.back}));return-1===a&&(a=Math.floor(4*Math.random())),t.splice(a,1,e),Object(x.a)({},e,{choices:t})})),o.next=17,Object(_.b)({type:"review-collection",status:"success",collection:Object(x.a)({},a.collection,{items:r}),cardIndex:0});case 17:case"end":return o.stop()}}),pe)}function Oe(e){var t,a,n,c,r,o,l,s;return I.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.answer,a=t.card,n=t.choice,c=a.id===n.id?{corrects:1}:{wrongs:1},i.next=4,he("/me/scorecard/".concat(a.id),c);case 4:if((r=i.sent).ok){i.next=9;break}return i.next=8,Object(_.b)({type:"answer-match",status:"error",error:r.error});case 8:return i.abrupt("return");case 9:return i.next=11,Object(_.b)({type:"answer-match",status:"success",scorecard:Object(x.a)({},r.scorecard,{card:a,correct:a.id===n.id})});case 11:return i.next=13,Object(_.c)((function(e){return{reviewCollection:e.review.reviewCollection,cardIndex:e.review.cardIndex}}));case 13:if(o=i.sent,l=o.reviewCollection,!((s=o.cardIndex)<l.items.length-1)){i.next=21;break}return i.next=19,Object(_.b)({type:"review-card",status:"success",cardIndex:s+1});case 19:i.next=25;break;case 21:return i.next=23,Object(_.b)({type:"review-result",status:"success"});case 23:return i.next=25,Object(_.b)(Object(h.replace)("/review/result"));case 25:case"end":return i.stop()}}),be)}function ge(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)((function(e){var t=e.type,a=e.status;return"review-collection"===t&&"pending"===a}),xe);case 2:return e.next=4,Object(_.d)((function(e){var t=e.type,a=e.status;return"answer-match"===t&&"pending"===a}),Oe);case 4:case"end":return e.stop()}}),fe)}var je=I.a.mark(_e),ke=I.a.mark(De),we=I.a.mark(Pe),ye=I.a.mark(Te),Ce=P("https://karteikarten.herokuapp.com"),Ne=Ce.post,Ie=Ce.put;function _e(e){var t,a,n,c,r;return I.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.type,a=e.mediaContext,n=e.file,(c=new FormData).append("file",n),o.prev=3,o.next=6,Ne("/media",c);case 6:if((r=o.sent).ok){o.next=12;break}return o.next=10,Object(_.b)({type:t,status:"error",error:r.error});case 10:o.next=14;break;case 12:return o.next=14,Object(_.b)({type:t,status:"success",mediaContext:a,media:r.media});case 14:o.next=20;break;case 16:return o.prev=16,o.t0=o.catch(3),o.next=20,Object(_.b)({type:t,status:"error",error:o.t0});case 20:case"end":return o.stop()}}),je,null,[[3,16]])}function Se(e,t){return I.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("Rotating media ".concat(e,"...")),a.abrupt("return",Ie("/media/".concat(e,"?op=").concat(t)));case 2:case"end":return a.stop()}}))}function De(e){var t,a,n,c;return I.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.type,a=e.mediaContext,n=e.media,r.prev=1,r.next=4,Se(n.id,"rotate_left");case 4:return c=r.sent,r.next=7,Object(_.b)({type:t,status:"success",mediaContext:a,media:c.media});case 7:r.next=13;break;case 9:return r.prev=9,r.t0=r.catch(1),r.next=13,Object(_.b)({type:t,status:"error",mediaContext:a,error:r.t0});case 13:case"end":return r.stop()}}),ke,null,[[1,9]])}function Pe(e){var t,a,n,c;return I.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.type,a=e.mediaContext,n=e.media,r.prev=1,r.next=4,Se(n.id,"rotate_right");case 4:return c=r.sent,r.next=7,Object(_.b)({type:t,status:"success",mediaContext:a,media:c.media});case 7:r.next=13;break;case 9:return r.prev=9,r.t0=r.catch(1),r.next=13,Object(_.b)({type:t,status:"error",mediaContext:a,error:r.t0});case 13:case"end":return r.stop()}}),we,null,[[1,9]])}function Te(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.d)((function(e){var t=e.type,a=e.status;return"upload-asset"===t&&"pending"===a}),_e);case 2:return e.next=4,Object(_.d)((function(e){var t=e.type,a=e.status;return"rotate-image-left"===t&&"pending"===a}),De);case 4:return e.next=6,Object(_.d)((function(e){var t=e.type,a=e.status;return"rotate-image-right"===t&&"pending"===a}),Pe);case 6:case"end":return e.stop()}}),ye)}var Le=I.a.mark(Me);function Me(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(_.a)([R(),ue(),ge(),Te()]);case 2:case"end":return e.stop()}}),Le)}var Fe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({shouldHotReload:!1}):v.d,Re=Object(E.a)(),Ae=Object(h.routerMiddleware)(f);var Be=a(90),Ve=a(91),ze=a(92),We=a(93),Ye=Object(d.b)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,a=e.className,n=e.children;return c.a.createElement(Be.a,{className:a},c.a.createElement(Ve.a,null,c.a.createElement(ze.a,null,c.a.createElement(We.a,{onClick:function(){return t(Object(h.replace)("/"))}},"Karteikarten")),n))})),Xe=a(54),Je=a.n(Xe),Ke=Object(d.b)(null,(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch;return c.a.createElement("div",{className:"container-fluid"},c.a.createElement("div",{className:"row justify-content-center"},c.a.createElement("div",{className:"col-7 karteikarten-login"},c.a.createElement("h1",null,"Login"),c.a.createElement(Je.a,{buttonText:"Login with Google",approvalPrompt:"force",clientId:"166406152582-opsa1qh4maknpa82s4vddn46psutaeth.apps.googleusercontent.com",scope:"profile email",onSuccess:function(e){return t({type:"login",status:"pending",authData:e})},onFailure:function(e){return t({type:"login",status:"error",authData:e})}}))))})),Ue=a(108),Ge=a(96),He=a(97),qe=a(95),$e=a(98),Qe=a(99),Ze=a(55),et=a(56),tt=a(94),at=a(24),nt=a(23),ct=function(e){var t=e.stats;return t.corrects_ratio>=.625?c.a.createElement(nt.a,{icon:at.d,className:"text-success",title:"Correct ratio ".concat(100*t.corrects_ratio,"%")}):c.a.createElement(nt.a,{icon:at.c,className:"text-warning",title:"Correct ratio ".concat(100*t.corrects_ratio,"%")})},rt=function(e){var t=e.dispatch,a=e.collections,n=e.className;return c.a.createElement(Ze.a,{className:n||"",flush:!0},a.map((function(e){return c.a.createElement(et.a,{className:"pl-0 pr-0"},c.a.createElement("div",{className:"float-right"},e.stats&&c.a.createElement(ct,{stats:e.stats}),c.a.createElement(tt.a,null,c.a.createElement(qe.a,{size:"sm",color:"link",onClick:function(){return t(Object(h.push)("/collections/".concat(e.id)))}},"View"),c.a.createElement(qe.a,{size:"sm",color:"link",onClick:function(){return t(Object(h.push)("/review/".concat(e.id)))}},"Review"))),c.a.createElement(c.a.Fragment,null,c.a.createElement(nt.a,{icon:at.a})," ",e.title))})))};rt.defaultProps={collections:[]};var ot=Object(d.b)(null,(function(e){return{dispatch:e}}))(rt),lt=function(e){var t=e.dispatch,a=e.isLoading,r=e.collections;return Object(n.useEffect)((function(){t({type:"fetch-recent-collections",status:"pending"})}),[]),a?c.a.createElement("div",{className:"text-center"},"Loading..."):r.length?c.a.createElement($e.a,null,c.a.createElement("h1",{className:"page-title"},"Dashboard"),c.a.createElement(He.a,null,c.a.createElement(Qe.a,{widths:[12]},c.a.createElement("h2",null,"Recent collections"),c.a.createElement(ot,{collections:r})))):c.a.createElement(Ue.a,{isOpen:!0},c.a.createElement(Ge.a,null,c.a.createElement("p",{className:"display-4 text-center"},"Welcome to Karteikarten!"),c.a.createElement("p",null,"Let's create your first collection!"),c.a.createElement(He.a,{className:"justify-content-center"},c.a.createElement(qe.a,{color:"primary",onClick:function(){return t(Object(h.replace)("/create-collection"))}},"Let's go!"))))};lt.defaultProps={isLoading:!0,collections:[]};var st=Object(d.b)((function(e){return{collections:e.coreData.collections,isLoading:e.network.busy}}),(function(e){return{dispatch:e}}))(lt),it=a(17),ut=a(100),mt=a(101),dt=Object(d.b)((function(e){return{newCollection:e.coreData.newCollection||void 0}}),(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,a=e.newCollection,r=void 0===a?{id:null,title:"",tags:""}:a,o=Object(p.e)(),l=Object(n.useState)(r),s=Object(it.a)(l,2),i=s[0],u=s[1],m=Object(n.useState)({id:null,isPristine:!0,front:"",back:""}),d=Object(it.a)(m,2),b=d[0],f=d[1];Object(n.useEffect)((function(){u(r)}),[r.id]),Object(n.useEffect)((function(){f({id:null,isPristine:!0,front:"",back:""})}),[r.id,r.items]);var v=o&&o.step||"step-0";return c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement("h1",{className:"page-title"},"Create Your Collection"),"step-0"===v&&c.a.createElement(c.a.Fragment,null,c.a.createElement(He.a,{className:"mb-2"},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Title"),c.a.createElement(mt.a,{className:"col-7 font-weight-bold",value:i.title,placeholder:"No name",onChange:function(e){var t=e.target.value;u(Object(x.a)({},i,{title:t}))}})),c.a.createElement(He.a,{className:"mb-2"},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Tags"),c.a.createElement(mt.a,{type:"textarea",className:"col-7",rows:2,onChange:function(e){var t=e.target.value;u(Object(x.a)({},i,{tags:t.split(/\n+|\s+/)}))}})),c.a.createElement(He.a,{className:"mt-2"},c.a.createElement("div",{className:"offset-3"},c.a.createElement(qe.a,{color:"primary",onClick:function(){return t({type:"create-collection",status:"pending",collection:i})}},"Create")))),"step-1"===v&&c.a.createElement(c.a.Fragment,null,c.a.createElement(He.a,null,c.a.createElement("ul",{className:"list-inline"},r.items&&r.items.map((function(e){return c.a.createElement("li",{className:"list-inline-item"},e.front)})))),c.a.createElement(He.a,null,c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Front"),c.a.createElement(mt.a,{className:"col-7 font-weight-bold",value:b.front,placeholder:"Empty",onChange:function(e){var t=e.target.value;f(Object(x.a)({},b,{isPristine:!1,front:t}))}})),c.a.createElement(He.a,{className:"pt-2"},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Back"),c.a.createElement(mt.a,{className:"col-7 font-weight-bold",value:b.back,placeholder:"Empty",onChange:function(e){var t=e.target.value;f(Object(x.a)({},b,{back:t}))}})),c.a.createElement(He.a,{className:"justify-content-center pt-3"},c.a.createElement(qe.a,{color:"primary",onClick:function(){return t({type:"create-card-in-new-collection",status:"pending",collection:r,card:b})}},"Add to Collection"),c.a.createElement(qe.a,{color:"default",onClick:function(){return t(Object(h.replace)("/collections"))}},"Finish"))))))})),pt=Object(d.b)((function(e){return{collections:e.coreData.collections||[]}}),(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,a=e.collections;return Object(n.useEffect)((function(){t({type:"fetch-collections",status:"pending"})}),[]),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement("h1",{className:"page-title"},"Your Collections"),c.a.createElement(He.a,{className:"justify-content-end pr-3"},c.a.createElement(qe.a,{color:"link",onClick:function(){return t(Object(h.push)("/create-collection"))}},"Create Collection")),c.a.createElement(ot,{collections:a}))))})),bt=a(31),ft=a(106),vt=a(103),Et=a(104),ht=a(102),xt=a(105),Ot=a(59),gt=function(e){var t=e.dispatch,a=e.media,r=e.mediaContext,o=e.collection,l=(o=void 0===o?{}:o).tags,s=void 0===l?[]:l,i=e.card,u=e.onSave,m=e.onClose,d=Object(n.useState)(i),p=Object(it.a)(d,2),b=p[0],f=p[1],v=Object(n.useCallback)((function(e){var a=(e||[]).filter((function(){return!0}));a.length&&t({type:"upload-asset",status:"pending",mediaContext:r,file:a[0]})}),[]),E=Object(n.useCallback)((function(e){e.stopPropagation();var n=a||Object(x.a)({id:i.media_id},i.media);t({type:"rotate-image-left",status:"pending",mediaContext:r,media:n})})),h=Object(n.useCallback)((function(e){e.stopPropagation();var n=a||Object(x.a)({id:i.media_id},i.media);t({type:"rotate-image-right",status:"pending",mediaContext:r,media:n})})),O=Object(Ot.a)({onDrop:v}),g=O.getRootProps,j=O.getInputProps,k=O.isDragActive;return Object(n.useEffect)((function(){f(Object(x.a)({},i,{isPristine:!0}))}),[i]),c.a.createElement(Ue.a,{isOpen:!0},c.a.createElement(ht.a,null,"Card"),c.a.createElement(Ge.a,null,c.a.createElement(vt.a,null,c.a.createElement(Et.a,{row:!0,inline:!0},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Front"),c.a.createElement("div",{className:"col-9"},c.a.createElement(mt.a,{className:"font-weight-bold",value:b.front,placeholder:"Empty",onChange:function(e){var t=e.target.value;f(Object(x.a)({},b,{isPristine:!1,front:t}))}}))),c.a.createElement(Et.a,{row:!0,inline:!0},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Back"),c.a.createElement("div",{className:"col-9"},c.a.createElement(mt.a,{className:"font-weight-bold",value:b.back,placeholder:"Empty",onChange:function(e){var t=e.target.value;f(Object(x.a)({},b,{isPristine:!1,back:t}))}}))),c.a.createElement(Et.a,{row:!0,inline:!0},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Tags"),c.a.createElement(Qe.a,{widths:[9],className:"pt-2"},(s||[]).map((function(e){return c.a.createElement(ut.a,{className:"form-check"},c.a.createElement(mt.a,{type:"checkbox",checked:b.tags.includes(e),onChange:function(t){var a;t.target.checked?a=[].concat(Object(bt.a)(b.tags),[e]):(a=Object(bt.a)(b.tags)).splice(a.indexOf(e),1),f(Object(x.a)({},b,{isPristine:!1,tags:a}))}}),e)})))),c.a.createElement("div",Object.assign({},g(),{className:"border border-secondary bg-light text-center pt-4 pb-4"}),c.a.createElement("input",j()),k?c.a.createElement("p",{className:"m-0"},"Drop the files here ..."):c.a.createElement("p",{className:"m-0"},"Drop in a picture or sound file"),i&&i.media&&i.media.url?c.a.createElement(He.a,{className:"justify-content-center card-media"},c.a.createElement("img",{className:"card-media-image",src:"".concat(i.media.url,"?t=").concat(Date.now())}),c.a.createElement("div",{className:"card-media-controls"},c.a.createElement(tt.a,null,c.a.createElement(qe.a,{color:"light",onClick:E},c.a.createElement(nt.a,{icon:at.e})),c.a.createElement(qe.a,{color:"light",onClick:h},c.a.createElement(nt.a,{icon:at.b}))))):a?c.a.createElement(He.a,{className:"justify-content-center card-media"},c.a.createElement("img",{className:"card-media-image",src:"".concat(a.url,"?t=").concat(Date.now())}),c.a.createElement("div",{className:"card-media-controls"},c.a.createElement(tt.a,null,c.a.createElement(qe.a,{color:"light",onClick:E},c.a.createElement(nt.a,{icon:at.e})),c.a.createElement(qe.a,{color:"light",onClick:h},c.a.createElement(nt.a,{icon:at.b}))))):null))),c.a.createElement(xt.a,null,c.a.createElement(qe.a,{color:"default",onClick:function(){return m()}},"Cancel"),c.a.createElement(qe.a,{color:"primary",onClick:function(){a&&b.media_id!==a.id?u(Object(x.a)({},b,{media_id:a.id})):u(b)}},"Save")))};gt.defaultProps={card:{isNew:!0}};var jt=Object(d.b)((function(e,t){var a=t.mediaContext;return a in e.media?{media:e.media[a]}:{media:null}}),(function(e){return{dispatch:e}}))(gt),kt=Object(d.b)(null,(function(e){return{dispatch:e}}))((function(e){e.dispatch;var t=e.card,a=e.onAccept,r=e.onClose,o=Object(n.useState)(null),l=Object(it.a)(o,2),s=l[0],i=l[1],u=Object(n.useState)(null),m=Object(it.a)(u,2),d=m[0],p=m[1],b=Object(n.useCallback)((function(){return D("/collections")}),[]),f=Object(n.useState)(null),v=Object(it.a)(f,2),E=v[0],h=v[1];return c.a.createElement(Ue.a,{isOpen:!0},c.a.createElement(ht.a,null,c.a.createElement("span",{className:"font-italic"},t.front)),c.a.createElement(Ge.a,null,c.a.createElement(vt.a,null,c.a.createElement(Et.a,{row:!0,inline:!0},c.a.createElement(ut.a,{className:"col-3 col-form-label text-right"},"Action"),c.a.createElement("div",{className:"form-check-inline"},c.a.createElement("label",{className:"form-check-label"},c.a.createElement(mt.a,{type:"radio",className:"form-check-input",name:"action",onClick:function(){i("MOVE"),b().then((function(e){var t=e.collections;return p(t)}))}})," Move")),c.a.createElement("div",{className:"form-check-inline"},c.a.createElement("label",{className:"form-check-label"},c.a.createElement(mt.a,{type:"radio",className:"form-check-input",name:"action",onClick:function(){i("COPY"),b().then((function(e){var t=e.collections;return p(t)}))}})," Copy")),c.a.createElement("div",{className:"form-check-inline"},c.a.createElement("label",{className:"form-check-label"},c.a.createElement(mt.a,{type:"radio",className:"form-check-input",name:"action",onClick:function(){i("CLONE"),p(null)}})," Clone"))),d&&c.a.createElement(Et.a,null,c.a.createElement(ut.a,null,"Move/Copy to..."),c.a.createElement("select",{className:"form-control",onChange:function(e){var t=e.target.value;return h(t)}},d.map((function(e){return c.a.createElement("option",{value:e.id},e.title)})))))),c.a.createElement(xt.a,null,c.a.createElement(qe.a,{color:"default",onClick:r},"Cancel"),c.a.createElement(qe.a,{color:"primary",onClick:function(){return a({action:s,cardId:t.id,collectionId:E})}},"OK")))})),wt=Object(d.b)((function(e){return{collection:e.coreData.editCollection||{id:null}}}),(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,a=e.collection,r=Object(p.e)().collectionId,o=Object(n.useState)({}),l=Object(it.a)(o,2),s=l[0],i=l[1],u=Object(n.useState)(!1),m=Object(it.a)(u,2),d=m[0],b=m[1],f=Object(n.useState)(!1),v=Object(it.a)(f,2),E=v[0],O=v[1],g=Object(n.useState)(null),j=Object(it.a)(g,2),k=j[0],w=j[1],y=Object(n.useState)(!1),C=Object(it.a)(y,2),N=C[0],I=C[1],_=Object(n.useCallback)((function(e,n,c){var r;e.target.checked?r=[].concat(Object(bt.a)(n.tags),[c]):(r=Object(bt.a)(n.tags)).splice(r.indexOf(c),1);var o=Object(x.a)({},n,{tags:r});t({type:"update-card-in-collection",status:"pending",collection:a,card:o})}),[s]);return Object(n.useEffect)((function(){t({type:"view-collection",status:"pending",collectionId:r})}),[]),Object(n.useEffect)((function(){i(a),b(!1),O(!1),I(!1)}),[a]),s&&s.items?c.a.createElement(c.a.Fragment,null,c.a.createElement(Be.a,null,c.a.createElement(Ve.a,null,c.a.createElement(ze.a,null,c.a.createElement(ft.a,{href:"javascript: void 0",onClick:function(){return t(Object(h.replace)("/collections"))}},"\u2039 Collections")))),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"row"},c.a.createElement("div",{className:"col-12"},c.a.createElement("h1",{className:"page-title"},"Your Collection"),c.a.createElement(vt.a,null,c.a.createElement(Et.a,{row:!0,inline:!0},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Title"),c.a.createElement("div",{className:"col-9"},c.a.createElement(mt.a,{className:"font-weight-bold",value:s.title,placeholder:"No name",onChange:function(e){var t=e.target.value;i(Object(x.a)({},s,{title:t}))},onBlur:function(){t({type:"update-collection",status:"pending",collection:s})}}))),c.a.createElement(Et.a,{row:!0,inline:!0},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Tags"),c.a.createElement("div",{className:"col-9"},c.a.createElement(mt.a,{type:"textarea",rows:2,placeholder:"Tags",value:s.tags?s.tags.join(" "):"",onChange:function(e){var t=e.target.value;i(Object(x.a)({},s,{tags:t.split(/\n+|\s+/)}))},onBlur:function(){t({type:"update-collection",status:"pending",collection:s})}}))),c.a.createElement(Et.a,{row:!0,inline:!0},c.a.createElement(ut.a,{className:"col-form-label text-right col-3"},"Cards"),c.a.createElement("div",{className:"col-9"},c.a.createElement(Ze.a,null,(a.items||[]).map((function(e){return c.a.createElement(et.a,{key:e.id,className:"d-flex align-items-baseline pt-1 pb-1 pr-0"},c.a.createElement("div",{className:"flex-grow-1"},e.front),c.a.createElement("div",{className:"flex-grow-0"},c.a.createElement("div",{className:"d-inline-block"},c.a.createElement(ut.a,{className:"form-check-label pr-1"},"Tags:"),(a.tags||[]).map((function(t){return c.a.createElement(ut.a,{className:"form-check-inline",key:t},c.a.createElement(mt.a,{type:"checkbox",checked:e.tags.includes(t),onChange:function(a){return _(a,e,t)}}),t)}))),c.a.createElement(qe.a,{size:"sm",color:"link",onClick:function(){w(e),O(!0)}},"View"),c.a.createElement(qe.a,{size:"sm",color:"default",onClick:function(){w(e),I(!0)}},"\u2026")))})))))),c.a.createElement(He.a,{className:"pt-3 justify-content-center"},c.a.createElement(qe.a,{color:"primary",onClick:function(){return b(!0)}},"Add new Card")))),d&&c.a.createElement(jt,{mediaContext:"card",onClose:function(){return b(!1)},onSave:function(e){t({type:"create-card-in-collection",status:"pending",collection:s,card:e})}}),E&&k&&c.a.createElement(jt,{mediaContext:"card",card:k,collection:s,onClose:function(){return O(!1)},onSave:function(e){t({type:"update-card-in-collection",status:"pending",collection:s,card:e})}}),N&&k&&c.a.createElement(kt,{card:k,onClose:function(){return I(!1)},onAccept:function(e){var n=e.action,c=e.cardId,r=e.collectionId;"MOVE"===n?t({type:"move-card",status:"pending",cardId:c,fromCollectionId:a.id,toCollectionId:r}):"COPY"===n?t({type:"copy-card",status:"pending",cardId:c,toCollectionId:r}):"CLONE"===n&&t({type:"clone-card",status:"pending",cardId:c,toCollectionId:a.id})}}))):c.a.createElement("div",{className:"text-center"},"Loading...")})),yt=a(107),Ct=Object(d.b)((function(e){return{collection:e.review.reviewCollection||{items:[]},cardIndex:e.review.cardIndex||0,lastScorecard:e.review.scorecards.length?e.review.scorecards[e.review.scorecards.length-1]:null,complete:e.review.complete,scorecards:e.review.scorecards}}),(function(e){return{dispatch:e}}))((function(e){var t=e.dispatch,a=e.collection,r=e.cardIndex,o=void 0===r?0:r,l=e.lastScorecard,s=void 0===l?null:l,i=e.scorecards,u=void 0===i?null:i,m=e.complete,d=void 0!==m&&m,b=Object(p.e)().collectionId,f=Object(n.useState)({}),v=Object(it.a)(f,2),E=v[0],x=v[1];return Object(n.useEffect)((function(){b&&t({type:"review-collection",status:"pending",collectionId:b})}),[b]),Object(n.useEffect)((function(){a&&a.items&&x(a.items[0])}),[a]),Object(n.useEffect)((function(){x(a.items[o])}),[a,o]),a&&E&&E.choices?c.a.createElement(c.a.Fragment,null,c.a.createElement(Be.a,null,c.a.createElement(Ve.a,null,c.a.createElement(ze.a,null,c.a.createElement(ft.a,{href:"javascript: void 0",onClick:function(){return t(Object(h.replace)("/collections"))}},"\u2039 Collections")))),c.a.createElement("div",{className:"container"},c.a.createElement(He.a,{className:"justify-content-center"},c.a.createElement("div",{className:"col-12 col-sm-10"},c.a.createElement("h1",{className:"page-title"},"Review"),s&&!d&&c.a.createElement(He.a,null,c.a.createElement(ut.a,{className:"col-4"},"Last card"),c.a.createElement("div",{className:"col-4"},s.card.front),c.a.createElement("div",{className:"col-4"},s.correct?c.a.createElement("span",null,"Correct!"):c.a.createElement("span",null,"Wrong!!!"))),!d&&c.a.createElement("div",{className:"w-100 p-3 p-sm-5 karteikarten-card"},c.a.createElement("h3",{className:"display-4 text-center font-weight-bold ".concat(!(E.media&&E.media.url)&&"mb-5")},E.front),E.media&&E.media.url&&c.a.createElement(He.a,{className:"justify-content-center mb-5"},c.a.createElement("img",{src:E.media.url})),c.a.createElement(He.a,{key:E.id},E.choices.map((function(e){return c.a.createElement(qe.a,{onClick:function(){return t({type:"answer-match",status:"pending",answer:{card:E,choice:e}})},key:"".concat(E.id,"-").concat(e.id),color:"link",className:"w-50"},e.back)})))),d&&u&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"w-100 p-3 p-sm-5 karteikarten-card"},c.a.createElement("h2",null,a.title),c.a.createElement(yt.a,{responsive:!0},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null),c.a.createElement("th",null,"Correct"),c.a.createElement("th",null,"Wrong"),c.a.createElement("th",null,"Skipped"))),c.a.createElement("tbody",null,u.map((function(e){var t=e.card,a=Object(A.a)(e,["card"]);return c.a.createElement("tr",null,c.a.createElement("td",null,t.front),c.a.createElement("td",null,a.corrects),c.a.createElement("td",null,a.wrongs),c.a.createElement("td",null,a.skippeds))}))))),c.a.createElement("div",{className:"w-100 text-center"},c.a.createElement(qe.a,{color:"link",onClick:function(){return t(Object(h.replace)("/review/".concat(a.id)))}},"Retry the collection"))))))):c.a.createElement("div",{className:"text-center"},"Loading...")})),Nt=function(){var e=Object(v.e)(C,Fe(Object(v.a)(Re,Ae)));return Re.run(Me),e}(),It=function(e){function t(){return Object(l.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return c.a.createElement(d.a,{store:Nt},c.a.createElement(p.c,{history:f},c.a.createElement(c.a.Fragment,null,c.a.createElement(Ye,{className:"karteikarten-topnav"}),c.a.createElement(p.d,null,c.a.createElement(p.b,{path:"/",exact:!0,component:st}),c.a.createElement(p.b,{path:"/login",exact:!0,component:Ke}),c.a.createElement(p.b,{path:"/create-collection",exact:!0,component:dt}),c.a.createElement(p.b,{path:"/create-collection/:step",exact:!0,component:dt}),c.a.createElement(p.b,{path:"/collections",exact:!0,component:pt}),c.a.createElement(p.b,{path:"/collections/:collectionId",exact:!0,component:wt}),c.a.createElement(p.b,{path:"/review/result",exact:!0,component:Ct}),c.a.createElement(p.b,{path:"/review/:collectionId",exact:!0,component:Ct}),c.a.createElement(p.a,{to:"/"})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(It,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[63,1,2]]]);
//# sourceMappingURL=main.b80e9619.chunk.js.map